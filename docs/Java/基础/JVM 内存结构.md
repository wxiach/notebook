# JVM 内存结构

![JVM 内存结构](/public/images/JVM%20内存结构.png)

## 程序计数器

程序计数器，也叫做 PC 寄存器（PC Register）。它主要有以下两个作用：

- 字节码解释器通过改变程序计数器的值来选择下一条要执行的字节码指令，从而实现代码的顺序执行、分支跳转、循环迭代等控制流。

- 程序计数器是线程私有的，用于记录当前线程所执行的位置，当线程切换回来时可以从这个位置继续执行。

程序计数器是唯一一个不会出现 `OutOfMemoryError` 的区域。它的生命周期和线程相同，线程创建时分配，线程结束时释放。

## Java 虚拟机栈

Java 虚拟机栈是调用 Java 方法使用的栈，每一次方法调用都会有一个**栈帧（Stack Frame）入栈**，方法执行完毕后，栈帧出栈。栈帧中存储了方法的局部变量、操作数栈、动态链接、方法出口等信息。

![Java 虚拟机栈](/public/images/Java%20虚拟机栈.png)

## 本地方法栈

本地方法栈是 Java 虚拟机调用本地方法（Native Method）时使用的栈。它和 Java 虚拟机栈类似，只不过它用于存储本地方法的参数、局部变量、返回值等信息。

## 堆

它是 Java 虚拟机中最大的一块内存区域，所有的对象实例和数组都在这里分配内存。

## 方法区

方法区是一个逻辑上的概念，用于存储类信息、常量、静态变量等数据的区域。在 JDK1.8 以后方法区由元空间实现，这样就可以使用本地内存，避免了 Java 堆的内存限制。

## 直接内存

直接内存是 Java 程序直接向操作系统申请的内存区域，不受 Java 堆的限制。
